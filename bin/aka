#!/usr/bin/env ruby

require 'optparse'
require 'methadone'
require 'aka'
require 'fileutils'

class App
  include Methadone::Main
  include Methadone::CLILogging
  include Aka

  main do |aliasString,value|
    al = AliasList.new
    options.each do |key, value|
      debug("#{key} : #{value}")
    end
    al.backup if options[:backup]
    al.list   if options[:list]
    al.show(aliasString) if options[:show]
    
    if options[:delete]
      al.empty
    elsif options[:add]
      al.add(aliasString,value)
    elsif options[:remove]
      al.remove(aliasString)
    end
  end

  # supplemental methods here

  # Declare command-line interface here

  description "Manage your aliases without editing dot files."

  on("-a", "--add",    "Add a new alias")
  on("-l", "--list",   "List all current aliases")
  on("-r", "--remove", "Remove the specified alias")
  on("-s", "--show",   "Show what the specified alias does")
  on("-b", "--backup", "Create a backup copy of your alias file")
  on("-d", "--delete", "Delete all keys from your alias file")

  arg :alias, :optional
  arg :value, :optional
  version Aka::VERSION

  use_log_level_option

  go!
end
